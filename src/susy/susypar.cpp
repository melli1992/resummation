#include <vector>
#include <iostream>
#include <fstream>
#include <sstream>
#include <gsl/gsl_math.h>
#include "parameters.h"

using namespace std;
//SUSY parameters (set later)
double SUSYset(0);
double tb(0);
double mA2(0.);
double mHeavy2(0.);
double GammaHeavy(0.);
double ght(0.);
double gHt(0.);
double gAt(0.);
double ghb(0.);
double gHb(0.);
double gAb(0.);
double lambdaZAh(0.);
double lambdaZAH(0.);
double lambdahhh(0.);
double lambdaHhh(0.);
double lambdaHHh(0.);
double lambdaHHH(0.);
double lambdahAA(0.);
double lambdaHAA(0.);


std::unordered_map<int, vector< vector<double> >> SUSYparameters ={
/*	Mh0,MHH,MA0,h0-h0-h0,h0-h0-HH,h0-HH-HH,h0-A0-A0,HH-HH-HH,HH-A0-A0,A0-Z-h,A0-Z-HH*/
{200,{{115.10835452,213.76950867,2.9851459873964603,-2.7484970757355383,1.8061002298518007,-0.3943260205941561,0.5706460417873649,0.5296322270299146,-0.0023845102036508642,-0.01050523368133615,0.9014097964992334,1.6392508682251465,-0.5464169560750488,2.7042293894976996,0.3333333333333333,3},
{122.37775245,206.05271791,4.031440944045443,-2.359311476946229,0.43115583995399775,-0.7251873749767439,1.0413025884675478,0.47208082253740113,-0.0018510007483310495,-0.010612246840337973,0.9507617294070356,1.844262277273374,-0.36885245545467477,4.753808647035179,0.2,5},
{124.30848734,201.65460901,4.689391246486093,-1.3836469818819304,-0.5746316453296021,-0.9126647172302425,0.7740332264126619,0.2770450467014994,-0.0010157061897304292,-0.010724471486883881,0.9861163076251025,1.9384175978316462,-0.19384175978316484,9.861163076251014,0.1,10},
{124.96668319,200.25126364,4.931340477865147,-0.48510954139761203,-0.934955670771076,-0.9743823506855551,0.2880454309209729,0.09676311054579914,-0.00034797487271272167,-0.010766844433904249,0.9984014034383835,1.9685461262158706,-0.06561820420719584,29.952042103151435,0.03333333333333333,30}
}},
{300,{{119.45035496,307.94387440,4.100966925599478,-2.643882385432981,0.9464475930202757,-0.46222637336313255,1.1324799319092782,0.47128429404344735,-0.0009401322176600354,-0.010731370785734856,0.9670939421160181,1.2579999062410538,-0.4193333020803513,2.901281826348054,0.3333333333333333,3},
{124.62532906,303.28873011,4.750655835853768,-1.8963389133211026,-0.16742673614212758,-0.7731893207592164,1.0826036272544162,0.38845717496212473,-0.0006587225501403653,-0.01075230556808524,0.9858989219508711,1.3038722684384216,-0.26077445368768426,4.929494609754356,0.2,5},
{124.95427139,300.91348886,4.914965747115836,-0.9978458889238077,-0.7689016878252197,-0.9282133087609169,0.6468877356993445,0.21936039394791557,-0.0003422668133157152,-0.010767022098252343,0.996317891471304,1.3172190073854393,-0.1317219007385441,9.96317891471303,0.1,10},
{125.03273813,300.18432457,4.957131419063428,-0.33751192314623185,-0.9582681943134489,-0.9762448652680716,0.2267393865387441,0.07572172958655853,-0.00011563589086148232,-0.010771848646375558,0.9995845714321359,1.3219743187180544,-0.044065810623935255,29.987537142964005,0.03333333333333333,30}
}},
{400,{{120.70922225,405.61649464,4.4217695168074895,-2.5387110135063966,0.6879518886887548,-0.48083967489842483,1.231856485015537,0.45203732299995397,-0.0005029988607144221,-0.010760715013895014,0.9833449461989603,1.1389883454472554,-0.3796627818157518,2.950034838596881,0.3333333333333333,3},
{125.21123059,402.26952888,4.910672192036904,-1.741261626014974,-0.30522735002512286,-0.7842104324859677,1.0617932099476977,0.3656806055365015,-0.0003440446412256403,-0.010766962876802979,0.9931023906265088,1.1591768817992476,-0.2318353763598495,4.965511953132546,0.2,5},
{125.11990592,400.60464509,4.959174559066507,-0.8979896420776958,-0.8076236324922602,-0.9314675274035014,0.6105997926011889,0.20509720397569967,-0.00017707980277783188,-0.010771019546084453,0.9982210653949396,1.164246735094916,-0.11642467350949172,9.982210653949386,0.1,10},
{125.04996335,400.09876263,4.961869135012596,-0.30182211668665865,-0.9627186862331982,-0.9766238825440052,0.2117966304350695,0.07065799955863881,-5.977549563412551e-05,-0.01077229280724579,0.9997996409039618,1.1664519893584417,-0.038881732978614816,29.99398922711878,0.03333333333333333,30}
}},
{500,{{121.25825785,504.21537489,4.545660788878222,-2.47949252521427,0.5772255448117715,-0.4889678188237155,1.2654528132400715,0.4436663711322685,-0.00031473861090032366,-0.01076788080926813,0.9898341061767381,1.0872239788763312,-0.36240799295877707,2.969502318530214,0.3333333333333333,3},
{125.46235774,501.68126769,4.971107681113473,-1.6726002776216624,-0.3597288498753597,-0.7886283526085663,1.0496705792627647,0.3561163414641194,-0.00021298295450874105,-0.010770368110141442,0.9958503238243385,1.0986597805845135,-0.21973195611690266,4.979251619121693,0.2,5},
{125.19371098,500.43198854,4.975875007787323,-0.8564250678411547,-0.8224793330653689,-0.9327407885648402,0.5951874104040531,0.19922273230597867,-0.0001091970980007661,-0.010771907867824922,0.998934953471129,1.1013155194417752,-0.11013155194417765,9.98934953471128,0.1,10},
{125.05929592,500.05255759,4.963675389218216,-0.28716776904138963,-0.9644153807574939,-0.9767719361674165,0.20565003620551817,0.0685813994366693,-3.686994189178617e-05,-0.01077241125014452,0.999880056045819,1.1026722856900637,-0.036755742856335545,29.996401681374497,0.03333333333333333,30}
}},
{600,{{121.55605625,603.31936194,4.606658881723755,-2.445019719539139,0.5193573055651574,-0.4932850624823944,1.2808948061618899,0.4392454899372014,-0.00021575158687726055,-0.010770308888692078,0.9931233992366685,1.059883590304824,-0.35329453010160805,2.979370197710005,0.3333333333333333,3},
{125.59809562,601.31448916,5.001577116811557,-1.6363360231032529,-0.38718391380078593,-0.7908669233945481,1.0426261878608463,0.35114470078996163,-0.00014517957686309915,-0.010771493317679369,0.9972137985433699,1.067293773928989,-0.21345875478579776,4.9860689927168504,0.2,5},
{125.23574608,600.32801531,4.9844621179451885,-0.834969136736362,-0.8298731310185385,-0.9333803802179778,0.587156981870214,0.19619918120866925,-7.428987338382133e-05,-0.010772203975071745,0.9992865932313133,1.0689389406395284,-0.10689389406395297,9.992865932313123,0.1,10},
{125.06643196,600.03121215,4.96462293240805,-0.2796348006822131,-0.9652592864109394,-0.9768459629791224,0.20248672248770833,0.06751393281187247,-2.5097093814308143e-05,-0.010772440860869203,0.9999196280307111,1.0698895882435069,-0.03566298627478365,29.99758884092126,0.03333333333333333,30}
}},
{700,{{121.74041818,702.53731192,4.650867693674425,-2.4268416956566767,0.4863798414864826,-0.4955058668335668,1.2889163514783242,0.4364976146866842,-0.00015710565155759064,-0.010771315653331275,0.9950323151179715,1.043645642370402,-0.34788188079013405,2.9850969453539142,0.3333333333333333,3},
{125.68228600,700.93613115,5.024791924962478,-1.6159786498841733,-0.40282429857797547,-0.792089846323927,1.0381934623759064,0.34820435582900944,-0.00010534731885264655,-0.010771937478549605,0.997996319307694,1.0488487337111039,-0.20976974674222074,4.98998159653847,0.2,5},
{125.26328781,700.15758067,4.991154141723388,-0.8225533598770747,-0.8341045035756389,-0.93374459213157,0.5824163048485782,0.19442638712194013,-5.3843016554751886e-05,-0.010772322417970475,0.9994876879697958,1.0499695994071503,-0.10499695994071515,9.994876879697946,0.1,10},
{125.07253170,699.89829699,4.965363200525107,-0.27522635599151263,-0.9657419412232608,-0.9768874179936775,0.20063220280085603,0.06688825819933551,-1.819986771406058e-05,-0.010772440860869203,0.9999422566478021,1.0506831268708436,-0.03502277089569487,29.99826769943399,0.03333333333333333,30}
}},
{800,{{121.86466923,802.16592412,4.648913385845393,-2.404604041420271,0.4618828889568179,-0.49802573950403023,1.294983588965727,0.43512663813389385,-0.00011976661656538751,-0.010771789424926192,0.9962322448323363,1.0332917444782552,-0.3444305814927518,2.9886967344970086,0.3333333333333333,3},
{125.73916800,800.80886329,5.030033023231245,-1.6010222728471448,-0.4130518428832411,-0.7929840902093324,1.0353834046035564,0.3463655298262388,-8.011453981462673e-05,-0.010772174364347062,0.9984849515011367,1.037157191868387,-0.20743143837367736,4.992424757505685,0.2,5},
{125.28300826,800.14218990,4.993315724625196,-0.8144696320388074,-0.8367783520144504,-0.9339814779290285,0.5794078552208567,0.19330562119271513,-4.091020683178694e-05,-0.01077238163941984,0.9996130222811538,1.0379694449229948,-0.10379694449229959,9.996130222811527,0.1,10},
{125.07813394,799.89887942,4.9655408648732005,-0.27242636586555463,-0.9660469316874883,-0.9769170287183597,0.1994578414599561,0.06649265891758002,-1.3834882683976333e-05,-0.010772470471593885,0.9999563659740371,1.0385275794112845,-0.03461758598037624,29.998690979221042,0.03333333333333333,30}
}},
{900,{{121.93026392,901.85357889,4.616815360289783,-2.378925620975783,0.4417327908105144,-0.5008802133634038,1.3001802711474701,0.43457883972727135,-9.437417649988074e-05,-0.010772055921448332,0.9970413947354652,1.0262436916520485,-0.34208123055068285,2.991124184206395,0.3333333333333333,3},
{125.78047351,900.68898472,5.024643871339067,-1.5890417736406872,-0.4203064704304039,-0.7937065918915804,1.0335179289485716,0.34514260689685994,-6.303557720019711e-05,-0.01077229280724579,0.9988125704577335,1.0292406071421683,-0.20584812142843362,4.9940628522886685,0.2,5},
{125.29814092,900.11091979,4.992693899406867,-0.8087902950447428,-0.8385905283650069,-0.9341472979872493,0.5773706373627147,0.19254847496258878,-3.216849908035438e-05,-0.01077241125014452,0.9996969239266602,1.0298572858203823,-0.10298572858203835,9.99696923926659,0.1,10},
{125.08344326,899.87656755,4.965363200525107,-0.2705226923757297,-0.9662512456877962,-0.9769347951531693,0.19866397793122373,0.06622497796645206,-1.08837623803123e-05,-0.010772470471593885,0.9999658120323964,1.0303093175114604,-0.03434364391704876,29.998974360971822,0.03333333333333333,30}
}},
{1000,{{121.97842121,1001.64040072,4.5629534520926835,-2.350185451599145,0.4239219399141125,-0.5040574441218143,1.3049920139083433,0.4345729175823349,-7.631317420136273e-05,-0.010772203975071745,0.9976135438059992,1.021227180863064,-0.34040906028768797,2.9928406314179976,0.3333333333333333,3},
{125.81206947,1000.61252283,5.010874884361798,-1.5785181220885984,-0.4258407148735253,-0.7943491446171862,1.0322535510046373,0.34430166231588266,-5.091747695614089e-05,-0.010772352028695156,0.9990435026794766,1.0236219975401404,-0.20472439950802804,4.9952175133973835,0.2,5},
{125.31032879,1000.09350612,4.9898512698373665,-0.8045204285455554,-0.8398963613234963,-0.9342716630309149,0.5759285950706868,0.19201252084583922,-2.5972623721714317e-05,-0.010772440860869203,0.9997559919378068,1.0241072494837582,-0.10241072494837593,9.997559919378057,0.1,10},
{125.08854277,999.85770662,4.9648598182055075,-0.26916000682585034,-0.9663933771662714,-0.9769466394430422,0.19810107805501323,0.06603517322123852,-8.791601822522228e-06,-0.010772470471593885,0.9999724631829772,1.0244830834095726,-0.0341494361136525,29.999173895489243,0.03333333333333333,30}
}},
{1500,{{122.12074095,1500.86033019,3.945273735219957,-2.1180136815101864,0.32708302591312666,-0.5297180981314933,1.3345257507064672,0.4406519993596106,-3.3860988881745144e-05,-0.01077241125014452,0.9989472967061787,1.0094249281797834,-0.3364749760599278,2.9968418901185356,0.3333333333333333,3},
{125.90346012,1500.28184183,4.8196488243635205,-1.5218491171916178,-0.44516171272872446,-0.7979705362458313,1.0305272457556596,0.34275598248746675,-2.25204070463967e-05,-0.010772440860869203,0.9995797046982472,1.0104505672639934,-0.20209011345279865,4.997898523491237,0.2,5},
{125.34468867,1499.96457796,4.944191532377265,-0.790594504727471,-0.8433223221692381,-0.9346921353214036,0.572579622109119,0.1907712392671573,-1.1471659630299573e-05,-0.010772470471593885,0.9998929427607728,1.0106484560519529,-0.10106484560519541,9.998929427607717,0.1,10},
{125.07469405,1499.71286270,4.954259178769245,-0.26565172816549176,-0.9667398226450542,-0.9769821723126609,0.19678162416317005,0.06559071624375724,-3.88918213945428e-06,-0.010772470471593885,0.9999879004163176,1.0108309051807185,-0.03369436350602403,29.999637012489455,0.03333333333333333,30}
}},
{2000,{{122.18852623,2000.44144165,2.7535871593084256,-1.7109846600273249,0.1844819213446373,-0.57483595932991,1.3811093427766576,0.454847380772304,-1.9067077007831026e-05,-0.010772440860869203,0.9994084406525379,1.0053083699901062,-0.33510278999670207,2.9982253219576136,0.3333333333333333,3},
{125.95195163,2000.08405270,4.432547820591845,-1.4378849462824947,-0.46472847959878666,-0.8035047806889526,1.0324874757296276,0.3430757783140356,-1.2660998075743798e-05,-0.010772470471593885,0.9997642464937645,1.0058758799269834,-0.20117517598539664,4.998821232468823,0.2,5},
{125.36553613,1999.86356334,4.849081884697725,-0.7778204380995277,-0.8453003185780156,-0.9351007633220193,0.5714958695857468,0.19036734898249077,-6.444756460667246e-06,-0.010772470471593885,0.9999399952612105,1.0059823992998227,-0.10059823992998237,9.999399952612093,0.1,10},
{125.07774010,1999.57166355,4.936966515554784,-0.26398020275717604,-0.9668730709061245,-0.9769969776750022,0.1963244345740754,0.0654367404754093,-2.187784839864591e-06,-0.010772470471593885,0.9999932096035765,1.0060927750777666,-0.033536425835925636,29.999796288107223,0.03333333333333333,30}
}},
{2500,{{122.23162698,2500.20812828,0.9584399365166063,-1.1077283271473457,-0.019908237747098458,-0.6417828467641165,1.4488261090526036,0.47678596668941825,-1.221949032644087e-05,-0.010772470471593885,0.9996212475279812,1.003402338753216,-0.33446744625107205,2.9988637425839433,0.3333333333333333,3},
{125.97109398,2499.95918832,3.8403333269458946,-1.3163418046790683,-0.49032695108663293,-0.8115737031648788,1.0367040429243868,0.34432831196809677,-8.104526411284069e-06,-0.010772470471593885,0.9998492489310693,1.0037614185150867,-0.2007522837030173,4.999246244655348,0.2,5},
{125.38120263,2499.78310761,4.702834515491857,-0.7616796320752074,-0.8472368599722379,-0.9356307952938324,0.571099085875004,0.19021485375037694,-4.1240247969095825e-06,-0.010772470471593885,0.9999616439039005,1.0038282084604353,-0.10038282084604365,9.999616439038993,0.1,10},
{125.08202007,2499.44155976,4.911353238704597,-0.26261929385077765,-0.9669559809352349,-0.9770117830373432,0.19611360621433743,0.06536567473617177,-1.4013402782013436e-06,-0.010772470471593885,0.9999956554640704,1.0039024592487362,-0.03346341530829129,29.99986966392204,0.03333333333333333,30}
}},
{5000,{{122.35477260,4999.60383330,-17.889200873911317,5.182587476794442,-2.121498863805293,-1.3404863895850134,2.148927278078505,0.7092271943729855,-3.07020279404636e-06,-0.010772470471593885,0.9999049586538508,1.0008549659840675,-0.33361832199468916,2.999714875961552,0.3333333333333333,3},
{126.04491469,4999.71497684,-2.364851643534287,-0.07092301554454537,-0.7411771663051846,-0.89453703157974,1.0856772204764387,0.36043950726773477,-2.0299019363948144e-06,-0.010772470471593885,0.999962294710405,1.0009421706260213,-0.2001884341252042,4.999811473552026,0.2,5},
{125.43089515,4999.46882937,3.096215815679758,-0.5989627778010461,-0.8639402697655219,-0.9410436357657564,0.5719814854705366,0.19048283080875172,-1.0325641675065547e-06,-0.010772470471593885,0.9999904096900039,1.0009585669755805,-0.10009585669755816,9.999904096900028,0.1,10},
{125.10268759,4998.73725411,4.631561501181567,-0.252614422195123,-0.9673379592836366,-0.9771213427186677,0.19584148365450713,0.06527388148965667,-3.521520576436534e-07,-0.010772470471593885,0.9999989098680829,1.000980637365801,-0.03336602124552678,29.999967296042417,0.03333333333333333,30}
}},
{7500,{{122.45008452,7499.36659731,-57.57272421428472,18.413014593541163,-6.5329253544812556,-2.8103864513940087,3.6194669315406376,1.1991544006764074,-1.3710449535643914e-06,-0.010772470471593885,0.9999575658889952,1.0003818260005533,-0.33346060866685107,2.9998726976669854,0.3333333333333333,3},
{126.09267203,7499.74122478,-15.770138972747379,2.611218795035939,-1.277987032998088,-1.073320665066516,1.1928295498842687,0.39611154729249864,-9.048794654967728e-07,-0.010772470471593885,0.9999831971296619,1.000419980037634,-0.2000839960075268,4.99991598564831,0.2,5},
{125.46639664,7499.32849951,-0.16548397649572205,-0.2723837264220121,-0.8966808480467382,-0.9519255770865008,0.5751083779969871,0.19152039060161943,-4.595859850432121e-07,-0.010772470471593885,0.9999957328102528,1.0004266270589546,-0.10004266270589557,9.999957328102516,0.1,10},
{125.11834969,7498.15349817,4.057320717417771,-0.23334524310811786,-0.9679893952266472,-0.9773375010088484,0.19581009628634385,0.06526322162877103,-1.5714464888199724e-07,-0.010772470471593885,0.9999995136313128,1.0004376359495044,-0.03334792119831689,29.99998540893931,0.03333333333333333,30}
}}
};
void set_SUSY(float mA, float TANB, bool printout = true){
	mA2 = pow(mA,2);
	double beta = atan(TANB);
	mHeavy2 = ((mA2+mZ2-mH2)*(mZ2*pow(cos(beta),2)+mA2*pow(sin(beta),2))-mA2*mZ2*pow(cos(2.*beta),2))/(mZ2*pow(cos(beta),2)+mA2*pow(sin(beta),2)-mH2);
	double alpha = atan(-((mZ2+mA2)*cos(beta)*sin(beta))/(mZ2*pow(cos(beta),2)+mA2*pow(sin(beta),2)-mH2));
	double eps = (mH2*(mA2+mZ2-mH2)-mA2*mZ2*pow(cos(2.*beta),2))/(mZ2*pow(cos(beta),2)+mA2*pow(sin(beta),2)-mH2);
	lambdahhh = 3.*cos(2.*alpha)*sin(alpha+beta)+3.*eps/mZ2*cos(alpha)/sin(beta)*pow(cos(alpha),2);
	lambdaHhh = 2.*sin(2.*alpha)*sin(alpha+beta)-cos(2.*alpha)*cos(alpha+beta)+3.*eps/mZ2*sin(alpha)/sin(beta)*pow(cos(alpha),2);
	ght = cos(alpha)/sin(beta);
	ghb = -sin(alpha)/cos(beta);
	gHt = sin(alpha)/sin(beta);
	gHb = cos(alpha)/cos(beta);
	if(printout){
		cout << "SUSY parameters have been set" <<endl;
		cout << "mA=" << sqrt(mA2) << ", mHeavy="<< sqrt(mHeavy2) <<", mH=" << sqrt(mH2) << ", tanb=" << TANB << endl;
		cout << "eps = " << eps << ", alpha=" << alpha << ", lhhh="<< lambdahhh <<", lHhh=" << lambdaHhh  << endl;
		cout << "ght=" << ght << ", ghb="<< ghb <<", gHt=" << gHt<<", gHb=" << gHb  << endl;
}
}
